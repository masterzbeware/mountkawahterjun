-- âœ… Obsidian UI Setup
local repo = "https://raw.githubusercontent.com/deividcomsono/Obsidian/main/"
local Library = loadstring(game:HttpGet(repo .. "Library.lua"))()

local Window = Library:CreateWindow({
    Title = "Hunting Hub",
    Footer = "v1.0.0",
    Icon = 0,
    NotifySide = "Right",
    ShowCustomCursor = true,
})

local Tabs = {
    Main = Window:AddTab("Main", "sword")
}

-- âœ… Services & Remotes
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RemoteEvents = ReplicatedStorage:WaitForChild("RemoteEvents")

local CaptureAnimal        = RemoteEvents:WaitForChild("CaptureAnimal")
local MinigameFinished     = RemoteEvents:WaitForChild("MinigameFinished")
local RunAnimalHitParticle = RemoteEvents:WaitForChild("RunAnimalHitParticle")
local LogCustomEvent       = RemoteEvents:WaitForChild("LogCustomEvent")
local FireGun              = RemoteEvents:WaitForChild("FireGun")
local ToggleItemLock       = RemoteEvents:WaitForChild("ToggleItemLock")
local SellItem             = RemoteEvents:WaitForChild("SellItem")

local AnimalsFolder = game.Workspace:WaitForChild("Animals")
local RunService    = game:GetService("RunService")

-- âœ… Config
local shootDir = Vector3.new(-0.61, 0.08, 0.78)

-- âœ… Toggle states
local autoHunt = false

-- âœ… Hunting Function
local function HuntTarget(model)
    if not autoHunt then return end

    local targetId = model.Name
    local mutation = model:GetAttribute("Mutation") or "None"
    local pos = model.PrimaryPart and model.PrimaryPart.Position or Vector3.zero

    -- tembak
    FireGun:FireServer(pos, shootDir, targetId)
    task.wait(0.2)

    RunAnimalHitParticle:FireServer("Perfect", targetId)
    LogCustomEvent:FireServer("HitPerfect")
    task.wait(0.2)

    MinigameFinished:FireServer(true)
    task.wait(0.2)

    CaptureAnimal:FireServer(tonumber(targetId))
    print("[AutoHunt] Tangkap:", targetId, "Mutation:", mutation)

    task.wait(0.5) -- tunggu masuk inventory

    if mutation ~= "None" then
        ToggleItemLock:FireServer(targetId)
        print("[AutoHunt] Mutation "..mutation.." â†’ AUTO LOCK âœ…")
    else
        SellItem:FireServer("All")
        print("[AutoHunt] Mutation None â†’ AUTO SELL ðŸ’°")
    end
end

-- âœ… Loop pakai Heartbeat
RunService.Heartbeat:Connect(function()
    if autoHunt then
        for _, model in ipairs(AnimalsFolder:GetChildren()) do
            if model:IsA("Model") then
                HuntTarget(model)
                task.wait(0.5) -- biar ga terlalu spam
            end
        end
    end
end)

-- âœ… UI
local GroupBox = Tabs.Main:AddLeftGroupbox("Automation")

GroupBox:AddToggle("AutoHuntToggle", {
    Text = "Auto Hunt (Sell None / Lock Mutasi)",
    Default = false,
    Callback = function(v)
        autoHunt = v
        Library:Notify("Auto Hunt: "..tostring(v), 3)
    end
})
